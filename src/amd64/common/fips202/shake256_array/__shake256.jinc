require "keccak1600.jinc"

inline fn __shake256(
  reg ptr u8[OUTLEN] out,
  reg ptr u8[INLEN] in
) -> reg ptr u8[OUTLEN]
{
  reg u64 rate;
  reg u8 trail_byte;

  trail_byte = 0x1F;
  rate = (1088/8);

  out = _keccak1600_(out, in, trail_byte, rate);
  
  return out;
}
